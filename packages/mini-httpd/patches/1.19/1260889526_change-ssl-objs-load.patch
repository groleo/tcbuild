diff -ruN mini_httpd-1.19.orig/keys/certs/ca.cer mini_httpd-1.19/keys/certs/ca.cer
--- mini_httpd-1.19.orig/keys/certs/ca.cer	2009-12-15 16:21:06.000000000 +0200
+++ mini_httpd-1.19/keys/certs/ca.cer	2009-12-15 16:48:40.000000000 +0200
@@ -1,22 +1,20 @@
 -----BEGIN CERTIFICATE-----
-MIIDjTCCAvagAwIBAgIJAJ8YAGNTJCrsMA0GCSqGSIb3DQEBBQUAMIGMMQswCQYD
-VQQGEwJSTzESMBAGA1UECBMJQnVjaGFyZXN0MRIwEAYDVQQHEwlCdWNoYXJlc3Qx
-EDAOBgNVBAoTB0NDb3N0aW4xEDAOBgNVBAsTB0NDb3N0aW4xDzANBgNVBAMTBkNv
-c3RpbjEgMB4GCSqGSIb3DQEJARYRY2Nvc3RpbkBnbWFpbC5jb20wHhcNMDkwMTE2
-MDkzNzE4WhcNMTExMDE0MDkzNzE4WjCBjDELMAkGA1UEBhMCUk8xEjAQBgNVBAgT
-CUJ1Y2hhcmVzdDESMBAGA1UEBxMJQnVjaGFyZXN0MRAwDgYDVQQKEwdDQ29zdGlu
-MRAwDgYDVQQLEwdDQ29zdGluMQ8wDQYDVQQDEwZDb3N0aW4xIDAeBgkqhkiG9w0B
-CQEWEWNjb3N0aW5AZ21haWwuY29tMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKB
-gQChtLjwLlII4jF7F5QzfzoMqSTG9CICw81wJaxFVu3ydEA3R5vv7+OJt+RSAxl1
-tmxVuNYcg2D4f2zt4yTZrVjL4JleMyCnQw0WYkDK+58yO98ZxI1fMmd0KL8Ja6Wx
-XZ6qx0nmBmPF5Ii3XdercZ9GfxrBoVCByOAx+EYvKmALBwIDAQABo4H0MIHxMB0G
-A1UdDgQWBBT0n1VYQlrfwYtmdw5guf2FtoEQajCBwQYDVR0jBIG5MIG2gBT0n1VY
-QlrfwYtmdw5guf2FtoEQaqGBkqSBjzCBjDELMAkGA1UEBhMCUk8xEjAQBgNVBAgT
-CUJ1Y2hhcmVzdDESMBAGA1UEBxMJQnVjaGFyZXN0MRAwDgYDVQQKEwdDQ29zdGlu
-MRAwDgYDVQQLEwdDQ29zdGluMQ8wDQYDVQQDEwZDb3N0aW4xIDAeBgkqhkiG9w0B
-CQEWEWNjb3N0aW5AZ21haWwuY29tggkAnxgAY1MkKuwwDAYDVR0TBAUwAwEB/zAN
-BgkqhkiG9w0BAQUFAAOBgQBKzy6H87gkeLeRcVGDe0iN0Lal0nGAUVvSnOxUcPoN
-EPau84fWGXC92NF7VH5GqG0JHumMSWp0NCALosn5abytDeSW5ssD/evCg0UZyztM
-Bozn3rJeHWUefwIauzqsbsvedT3D/DNQqaU0giEbpP8WfdC8VgGsjAaIVS9vvvJi
-Pw==
+MIIDTzCCArigAwIBAgIJAOSUqOMfNnj4MA0GCSqGSIb3DQEBBQUAMHkxCzAJBgNV
+BAYTAlVTMRAwDgYDVQQIEwdHZW9yZ2lhMRAwDgYDVQQHEwdBdGxhbnRhMRIwEAYD
+VQQKEwlOaXZpcyBMTEMxDjAMBgNVBAsTBVNXZGVwMQ0wCwYDVQQDEwRnYWJpMRMw
+EQYJKoZIhvcNAQkBFgRnYWJpMB4XDTA5MTIxNTEyMTMxOVoXDTE5MTIxMzEyMTMx
+OVoweTELMAkGA1UEBhMCVVMxEDAOBgNVBAgTB0dlb3JnaWExEDAOBgNVBAcTB0F0
+bGFudGExEjAQBgNVBAoTCU5pdmlzIExMQzEOMAwGA1UECxMFU1dkZXAxDTALBgNV
+BAMTBGdhYmkxEzARBgkqhkiG9w0BCQEWBGdhYmkwgZ8wDQYJKoZIhvcNAQEBBQAD
+gY0AMIGJAoGBAO70kGG+2xY8OnPeTE2mNu8gsiIJWp4MQXroF7AUoIlPpGsAXfct
+nYpwZoENS5eFd8plqAFaQ21pWo+/qY0OhR4PPjt33Ma3mOAv7ZFtDJ+kdJZ6GYvJ
+eNWFao4n+d79+Ylzy3CiN/SE+4k+K+k+GHl6VvNdcElRYobry30WcUiPAgMBAAGj
+gd4wgdswHQYDVR0OBBYEFOqumcQYJLflta2eHtWZzQhEI79rMIGrBgNVHSMEgaMw
+gaCAFOqumcQYJLflta2eHtWZzQhEI79roX2kezB5MQswCQYDVQQGEwJVUzEQMA4G
+A1UECBMHR2VvcmdpYTEQMA4GA1UEBxMHQXRsYW50YTESMBAGA1UEChMJTml2aXMg
+TExDMQ4wDAYDVQQLEwVTV2RlcDENMAsGA1UEAxMEZ2FiaTETMBEGCSqGSIb3DQEJ
+ARYEZ2FiaYIJAOSUqOMfNnj4MAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEFBQAD
+gYEA2xnX7r50c/GxTjgrRCQq0dUksDmEWg2vMOq1oGbu/x79ePQdd2UBDrmVFRb2
+z1iMHsnqhCKcj4HWvS4zsfUEetVhBT/Jn52JkigP5MopFlcAhh6b5hlwjwSmLSIt
+BT/Fwz9oWSzNeg7FyBktd92l0bSZntoK1yML3lEvsT8+nfw=
 -----END CERTIFICATE-----
diff -ruN mini_httpd-1.19.orig/keys/keys/ca.key mini_httpd-1.19/keys/keys/ca.key
--- mini_httpd-1.19.orig/keys/keys/ca.key	2009-12-15 16:21:06.000000000 +0200
+++ mini_httpd-1.19/keys/keys/ca.key	2009-12-15 16:48:53.000000000 +0200
@@ -1,18 +1,15 @@
 -----BEGIN RSA PRIVATE KEY-----
-Proc-Type: 4,ENCRYPTED
-DEK-Info: DES-EDE3-CBC,6FD9671CBE1E2DFB
-
-d3oF10Rzqb95794XtTu1EEsUXvkAkZqbY06d00OgOM6eh/sDR008QN2i4Vn/wqRF
-KWLoy7RrqfpS3r0zs3ZvA3Gq9Gvo9mFNLjDHFM6A0cQOYhdRcyvGxjrj8H5Igrm6
-lcFk1OXUA10D6xjVBk7p4U3pEES+IGpOAw6/vEzsIWsxOjmgBHd5HU4xko8+yHNI
-tqhokEaI+xWq6dNA8W9aSJ6o/b3ubpnaVFACeSUTPi0wd1xkAIpR5INo/CxH7VPr
-Y2GwNUU46ibD7q9QpUkNgU2Mce3dy+w8Exbtwa83+fnPvciOT/hb4RlV4c5+th/v
-S+isJchlaqSYKFq/TDYKGYIDbW5ZjH4XAkXL3IUyEhD68J+XnChrSGuK9m4wEGrs
-3O6dexzpnlhZ66F8uB7NJgLVoANux4zWxn8n7+RHmEAfUqljVaYi1++C3nXbmZt4
-UuJxC4S3sTsvxDOEBxvgb0j+gdpaw59F1xhYejD1E2JhjcNFI+NsjtFO0+ejoEpR
-cAN5N0Zh403qn/vkjrFp//j+RVPAAhdvixaDYMW41LKqSx1g5zIP72t1bgXLgY3X
-Urw1+jB9YwYAZDK4jBNkb+TVdczHyKHWAmfAd2D60Y+tP5VLVHb48ozaf4YO+5Kt
-G9MczwVAeO+g4GTqkrxVbCF3QE/PXMOT3OKlrKtWltbZBZgb7IbOPfH1DlCf3JsZ
-35EHzilebalm8JhkU6VyB3ZTmATZeqTUpt3Oc7EIntkl0yvUfg7jw+593EBVPmCr
-mjiDpeJ6yohylfzbIfo+xT3E5jDWGeTdygEBXIycaQ8ph49cWbUkeA==
+MIICXQIBAAKBgQDu9JBhvtsWPDpz3kxNpjbvILIiCVqeDEF66BewFKCJT6RrAF33
+LZ2KcGaBDUuXhXfKZagBWkNtaVqPv6mNDoUeDz47d9zGt5jgL+2RbQyfpHSWehmL
+yXjVhWqOJ/ne/fmJc8twojf0hPuJPivpPhh5elbzXXBJUWKG68t9FnFIjwIDAQAB
+AoGBAOB6A0CvyKTkw4yh4lB3utd9gZoT63rZzJGngsk5N26G0NBsMdnIklzBJqpJ
+UR/wlA4g3WkX4IviEt9DkAYhA87ekRkNROuqUOCZvgIivvP+p/2hHno+Ustu7tO6
+ebcsK8GZ7tvfaZEaIw+L4JGfA+Lhl7oHy9zwydEpW5QLPNVRAkEA+UJ7AnzTNL/g
+/o/yF4dfyGjfNn4huUPDScLyEgHBxOJQx4V7GDeFITMuYDNjnxeGi/1NY5YNF3rG
+qwZZvANDWwJBAPVqwDDba0stHLirRaGtLD46UbFZJyFtDrMiNJ4ZxYdAZW60uXYN
+o6RmQefxB/SfMQfnUVW7LeC+SUaDd4kY2d0CQQDOn8yGsGEIrjLd8wd1d7Pv1veK
+HZ7pDAI8CA1Q3gH5qr3Z143F8mg6sEm2V4Myo3bWXwEjF4T8vLsplNcYIwBXAkAH
+Eew3fBq7L7GEIGsBHVwI7uUrlsXp0Jp7zqB1bYijPNevOMWfAQWV1txPMkJoaa2f
+7KoLLjlEIDc8MM1gxbaBAkBlUIosQMIeIxW09NnakWfb6G2q+mzJ3ZnZIp2v8JGH
+BSrYt5r+8j+jVtMHGklLvROVZa/o5mlqRXKYG260/4bl
 -----END RSA PRIVATE KEY-----
diff -ruN mini_httpd-1.19.orig/mini_httpd.c mini_httpd-1.19/mini_httpd.c
--- mini_httpd-1.19.orig/mini_httpd.c	2009-12-15 16:21:06.000000000 +0200
+++ mini_httpd-1.19/mini_httpd.c	2009-12-15 16:44:20.000000000 +0200
@@ -571,10 +571,18 @@
 
 	    if (ssl_obj_load (ssl_ctx, SSL_OBJ_RSA_KEY, certfile, 0)!=SSL_OK)
 	    {
-		//printf("ssl_obj_load() error");
+		//printf("ssl_obj_load() error - cert");
 		ERR_print_errors_fp( stderr );
 		exit(1);
 	    }
+
+            if (ssl_obj_load (ssl_ctx, SSL_OBJ_X509_CERT, certfile, 0)!=SSL_OK)
+	    {
+		//printf("ssl_obj_load() error - key");
+		ERR_print_errors_fp( stderr );
+		exit(1);
+	    }
+
 	}
 	if ( cipher != (char*) 0 )
 	    {
